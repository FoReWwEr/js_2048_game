const t=new class{constructor(t){this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.starting=!1,this.table=document.querySelector(".game-field"),this.score=0,this.block=!1}copyBoard(t){return t.map(t=>t.slice())}boardsAreEqual(t,e){for(let s=0;s<t.length;s++)for(let r=0;r<t[s].length;r++)if(t[s][r]!==e[s][r])return!1;return!0}checkForLoss(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!1;return!0}moveLeft(){if(this.starting&&!this.block){let t=this.copyBoard(this.board);this.board.forEach(t=>{let e=t.filter(t=>0!==t);for(let t=0;t<e.length;t++)if(e[t]===e[t+1]){let s=e[t]*=2;e[t]=s,e.splice(t+1,1),this.score+=s}for(;e.length<t.length;)e.push(0);t.splice(0,t.length,...e)}),this.boardsAreEqual(t,this.board)||this.spawn(),this.updateTable(),this.getScore(),this.getState()}}moveRight(){if(this.starting&&!this.block){let t=this.copyBoard(this.board);this.board.forEach(t=>{let e=t.filter(t=>0!==t);for(let t=e.length-1;t>0;t--)if(e[t]===e[t-1]){let s=e[t]*=2;e[t]=s,e.splice(t-1,1),this.score+=s}for(;e.length<t.length;)e.unshift(0);t.splice(0,t.length,...e)}),this.boardsAreEqual(t,this.board)||this.spawn(),this.updateTable(),this.getScore(),this.getState()}}moveUp(){if(this.starting&&!this.block){let t=this.copyBoard(this.board);for(let t=0;t<4;t++){let e=[];for(let s=0;s<4;s++){let r=this.board[s][t];r>0&&e.push(r)}for(let t=0;t<e.length;t++)if(e[t]===e[t+1]){let s=e[t]*=2;e[t]=s,e.splice(t+1,1),this.score+=s}for(;e.length<4;)e.push(0);for(let s=0;s<4;s++)this.board[s][t]=e[s]}this.boardsAreEqual(t,this.board)||this.spawn(),this.updateTable(),this.getScore(),this.getState()}}moveDown(){if(this.starting&&!this.block){let t=this.copyBoard(this.board);for(let t=0;t<4;t++){let e=[];for(let s=0;s<4;s++){let r=this.board[s][t];r>0&&e.push(r)}for(let t=e.length-1;t>0;t--)if(e[t]===e[t-1]){let s=e[t]*=2;e[t]=s,e.splice(t-1,1),this.score+=s}for(;e.length<4;)e.unshift(0);for(let s=0;s<4;s++)this.board[s][t]=e[s]}this.boardsAreEqual(t,this.board)||this.spawn(),this.updateTable(),this.getScore(),this.getState()}}getScore(){document.querySelector(".game-score").innerHTML=this.score}getState(){this.board.forEach(t=>{t.forEach(t=>{2048===t&&(document.querySelector(".message-win").classList.remove("hidden"),this.block=!0)})}),this.checkForLoss()?(document.querySelector(".message-lose").classList.remove("hidden"),this.block=!0):(document.querySelector(".message-lose").classList.add("hidden"),this.block=!1)}getStatus(){if(this.starting){let t=document.querySelector(".message-start"),e=document.querySelector(".button");t.style.visibility="hidden",e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart")}else{let t=document.querySelector(".message-start"),e=document.querySelector(".button");t.style.visibility="visible",e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start"}}random(){return Array.from({length:16},(t,e)=>e).sort(()=>.5-Math.random()).slice(0,2)}start(){if(this.starting)this.restart();else{let t=this.random();this.board.map((e,s)=>{e.map((e,r)=>{t.includes(4*s+r)&&(this.board[s][r]=Math.random()>.1?2:4)})}),this.starting=!0,this.updateTable(),this.getStatus()}}updateTable(){let t=document.querySelectorAll(".field-row");this.board.forEach((e,s)=>{t[s]&&e.forEach((e,r)=>{let o=t[s].children[r];if(o&&e>0){o.textContent=e;for(let t=1;t<2048;t*=2)o.classList.remove(`field-cell--${t}`);o.classList.add("field-cell",`field-cell--${e}`)}else{o.textContent="";for(let t=1;t<=2048;t*=2)o.classList.remove(`field-cell--${t}`)}})})}restart(){let t=document.querySelectorAll(".field-row");this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.starting=!1,this.getStatus(),this.score=0,this.getScore(),this.getState(),this.board.forEach((e,s)=>{e.forEach((e,r)=>{let o=t[s].children[r];o.innerHTML="";for(let t=1;t<=2048;t*=2)o.classList.remove(`field-cell--${t}`)})}),document.querySelector(".message-win").classList.add("hidden"),this.block=!1}spawn(){let t=[];if(this.board.forEach((e,s)=>{e.forEach((e,r)=>{0===e&&t.push({rowIndex:s,cellIndex:r})})}),t.length>0){let e=Math.floor(Math.random()*t.length),{rowIndex:s,cellIndex:r}=t[e];this.board[s][r]=Math.random()>.1?2:4,this.updateTable()}}};document.querySelector(".start").addEventListener("click",()=>{t.start()}),document.addEventListener("keydown",e=>{switch(e.key){case"ArrowRight":t.moveRight();break;case"ArrowLeft":t.moveLeft();break;case"ArrowDown":t.moveDown();break;case"ArrowUp":t.moveUp()}});
//# sourceMappingURL=index.2824478b.js.map
